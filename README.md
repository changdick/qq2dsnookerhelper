# QQ游戏2D桌球斯诺克瞄准辅助

## 原理
本工具通过图像识别与几何计算实现自动瞄准。主要流程如下：
1. 利用Windows API获取游戏窗口图像，不会受到DPI缩放的影响。   
2. 图像处理、目标检测：通过HSV色彩空间转换、连通分量提取的方法，识别桌面范围，提取出球的坐标、半径。  
3. 击打点计算：硬编码袋口坐标，使用三点一线瞄准原理计算出打点。   

## 项目结构

```
/
├── robot.py                # 主程序入口，整合功能实现自动瞄准
├── tab1e.py                # 对球坐标、袋口坐标建模，求解击打点
├── extract.py              # 窗口图像获取模块
├── test.ipynb              # 实验用的文件
├── ts.py                   # 根据进程名获取对应窗口的图像
└── README.md               # 项目说明文档
```

## 使用说明
### 项目依赖
Python 环境： 需要安装以下依赖：  
```
pip install numpy opencv-python pillow win32api win32gui scipy matplotlib
```  

### 使用步骤
需要在管理员模式下用终端命令运行。因为用到windows api移动鼠标，需要管理员模式。  
1. 右键点击开始菜单，选择 "Windows Terminal (管理员)" 或 "命令提示符 (管理员)"  
2. 输入命令 `cd 本项目目录`   
3. 确保游戏窗口已经打开，并且为大分辨率模式。   
4. 输入命令 `python ./robot.py` 启动脚本。   